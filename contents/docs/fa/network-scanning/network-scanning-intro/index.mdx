---
title: مقدمه‌ای بر اسکن شبکه
description: درک مبانی اسکن شبکه و روش‌شناسی در هک اخلاقی
---

## اسکن شبکه چیست؟

اسکن شبکه دومین مرحله هک اخلاقی است که شامل بررسی فعالانه شبکه هدف برای شناسایی هاست‌های زنده، پورت‌های باز، سرویس‌ها و آسیب‌پذیری‌ها است. این مرحله اطلاعات حیاتی برای تست نفوذ فراهم می‌کند.

## اهداف اسکن شبکه

- **کشف هاست‌های زنده**: شناسایی دستگاه‌های فعال در شبکه
- **شناسایی پورت‌های باز**: یافتن پورت‌های قابل دسترس در سیستم‌های هدف
- **تشخیص سرویس‌ها**: تعیین سرویس‌های در حال اجرا بر روی پورت‌های باز
- **تشخیص سیستم‌عامل**: شناسایی سیستم‌عامل هاست‌های هدف
- **یافتن آسیب‌پذیری‌ها**: کشف نقاط ضعف امنیتی احتمالی

## انواع اسکن شبکه

### اسکن پورت
بررسی اینکه کدام پورت‌ها در سیستم‌های هدف باز، بسته یا فیلتر شده هستند.

**وضعیت پورت‌ها:**
- **باز (Open)**: پورت در حال پذیرش اتصال است
- **بسته (Closed)**: پورت قابل دسترس است اما سرویسی گوش نمی‌دهد
- **فیلتر شده (Filtered)**: پورت توسط فایروال یا دستگاه فیلتر مسدود شده

### اسکن شبکه
شناسایی هاست‌های زنده و آدرس‌های شبکه آنها.

**تکنیک‌ها:**
- درخواست‌های ICMP Echo (Ping)
- اسکن ARP
- اسکن TCP/UDP

### اسکن آسیب‌پذیری
اسکن خودکار برای شناسایی آسیب‌پذیری‌های شناخته شده.

## دست‌دهی سه‌مرحله‌ای TCP

درک دست‌دهی TCP برای اسکن پورت حیاتی است:

1. **SYN**: کلاینت بسته SYN به سرور ارسال می‌کند
2. **SYN-ACK**: سرور با SYN-ACK پاسخ می‌دهد
3. **ACK**: کلاینت ACK ارسال می‌کند تا اتصال کامل شود

## تکنیک‌های رایج اسکن پورت

### اسکن TCP Connect
دست‌دهی کامل TCP سه‌مرحله‌ای را تکمیل می‌کند. قابل اعتمادترین اما به راحتی قابل تشخیص.

### اسکن SYN (نیمه‌باز)
بسته SYN ارسال می‌کند و پاسخ را بدون تکمیل دست‌دهی تحلیل می‌کند. مخفی‌تر از اسکن connect.

### اسکن FIN
بسته FIN ارسال می‌کند تا بررسی کند پورت باز است. در برابر سیستم‌هایی که از RFC 793 پیروی می‌کنند کار می‌کند.

### اسکن NULL
بسته بدون فلگ ارسال می‌کند. برای دور زدن فایروال‌های ساده استفاده می‌شود.

### اسکن XMAS
بسته با فلگ‌های FIN، PSH و URG ارسال می‌کند. "XMAS" نامیده می‌شود چون فلگ‌ها مثل درخت کریسمس روشن می‌شوند.

### اسکن ACK
برای نقشه‌برداری قوانین فایروال و تعیین فیلتر بودن پورت‌ها استفاده می‌شود.

### اسکن UDP
پورت‌های UDP را که بدون اتصال هستند اسکن می‌کند. کندتر و کم‌اعتمادتر از اسکن‌های TCP.

### اسکن Idle
از یک هاست زامبی برای اسکن هدف استفاده می‌کند، باعث می‌شود اسکن از منبع دیگری ظاهر شود.

## روش‌شناسی اسکن

### 1. بررسی سیستم‌های زنده
شناسایی کدام هاست‌ها در شبکه فعال هستند.

### 2. بررسی پورت‌های باز
تعیین کدام پورت‌ها در هاست‌های زنده قابل دسترس هستند.

### 3. گرفتن بنر
ضبط بنرهای سرویس برای شناسایی نسخه‌های نرم‌افزار.

### 4. اسکن آسیب‌پذیری‌ها
استفاده از اسکنرهای آسیب‌پذیری برای یافتن نقاط ضعف امنیتی.

### 5. ترسیم نمودارهای شبکه
نقشه‌برداری توپولوژی شبکه و روابط.

### 6. آماده‌سازی پروکسی‌ها
استفاده از پروکسی‌ها برای مخفی کردن منشأ اسکن و اجتناب از تشخیص.

## ابزارهای رایج اسکن شبکه

- **Nmap**: محبوب‌ترین اسکنر پورت
- **Hping3**: ابزار ساخت و تحلیل بسته
- **Masscan**: اسکنر سریع پورت برای شبکه‌های بزرگ
- **Nessus**: اسکنر آسیب‌پذیری
- **OpenVAS**: اسکنر آسیب‌پذیری متن‌باز
- **Angry IP Scanner**: اسکنر سریع IP و پورت

## ملاحظات اسکن

### قانونی و اخلاقی
- همیشه مجوز مناسب دریافت کنید
- در محدوده تعامل بمانید
- شیوه‌های افشای مسئولانه را دنبال کنید

### فنی
- به پهنای باند شبکه احترام بگذارید
- از انکار سرویس اجتناب کنید
- زمان‌بندی و شدت مناسب استفاده کنید
- تشخیص IDS/IPS را در نظر بگیرید

### تکنیک‌های مخفیانه
- از نرخ اسکن کند استفاده کنید
- ترتیب اسکن را تصادفی کنید
- بسته‌ها را تکه‌تکه کنید
- از پروکسی یا VPN استفاده کنید
- آدرس‌های منبع را جعل کنید (با احتیاط)

## دفاع در برابر اسکن

### سطح شبکه
- فایروال‌ها را به درستی پیکربندی کنید
- سیستم‌های IDS/IPS پیاده‌سازی کنید
- از تقسیم‌بندی شبکه استفاده کنید
- محدودیت نرخ و throttling

### سطح سیستم
- پورت‌های غیرضروری را ببندید
- سرویس‌های استفاده نشده را غیرفعال کنید
- سیستم‌ها را به‌روز نگه دارید
- از فایروال‌های مبتنی بر هاست استفاده کنید
- لاگ‌های سیستم را نظارت کنید
