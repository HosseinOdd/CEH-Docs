---
title: اسکن Idle
description: تکنیک پیشرفته اسکن مخفیانه با استفاده از هاست‌های زامبی برای اسکن ناشناس پورت
---

## اسکن Idle چیست؟

اسکن Idle (که به عنوان اسکن zombie نیز شناخته می‌شود) یکی از مخفیانه‌ترین تکنیک‌های اسکن پورت است. این روش به شما اجازه می‌دهد بدون ارسال هیچ بسته‌ای از آدرس IP واقعی خود، با استفاده از یک هاست واسطه "zombie" هدف را اسکن کنید.

## نحوه کار اسکن Idle

### توالی IP ID

هر بسته IP دارای یک فیلد ID است که معمولاً برای هر بسته ارسالی 1 واحد افزایش می‌یابد. اسکن Idle از این رفتار قابل پیش‌بینی سوء استفاده می‌کند.

### فرآیند سه‌مرحله‌ای

1. **بررسی Zombie**: IP ID فعلی zombie را بررسی کنید
2. **جعل Zombie**: بسته SYN به هدف ارسال کنید، جعلی از zombie
3. **بررسی مجدد**: بررسی کنید آیا IP ID zombie افزایش یافته است

### تحلیل پاسخ

**اگر پورت باز باشد:**
- هدف SYN-ACK به zombie ارسال می‌کند
- Zombie با RST پاسخ می‌دهد (افزایش IP ID)
- IP ID به میزان 2 افزایش می‌یابد

**اگر پورت بسته باشد:**
- هدف RST به zombie ارسال می‌کند
- Zombie آن را نادیده می‌گیرد (بدون پاسخ)
- IP ID به میزان 1 افزایش می‌یابد

## الزامات هاست Zombie

### ویژگی‌ها
- باید idle باشد (ترافیک زیادی ارسال نکند)
- باید توالی IP ID قابل پیش‌بینی داشته باشد
- باید آنلاین و پاسخگو باشد
- نباید پشت فایروالی باشد که پاسخ‌ها را مسدود می‌کند

### یافتن هاست‌های Zombie

```bash
# تست IP ID قابل پیش‌بینی
nmap -O -v zombie_candidate

# به دنبال "IP ID Sequence Generation: Incremental" بگردید
```

## انجام اسکن Idle با Nmap

### نحو پایه
```bash
nmap -sI zombie_host:port target
```

### مثال‌ها

**اسکن ساده Idle:**
```bash
nmap -sI 192.168.1.100 target.com
```

**اسکن پورت‌های خاص:**
```bash
nmap -sI 192.168.1.100 -p 80,443 target.com
```

**اسکن کامل پورت:**
```bash
nmap -sI 192.168.1.100 -p- target.com
```

**حالت پرحرف:**
```bash
nmap -sI 192.168.1.100 -v target.com
```

## فرآیند گام به گام

### 1. یافتن Zombie مناسب
```bash
# اسکن برای zombie‌های احتمالی
nmap -O -v 192.168.1.0/24

# تست قابلیت اعتماد zombie
hping3 -S -r zombie_host
```

### 2. تأیید Idle بودن Zombie
```bash
# بررسی افزایش IP ID
hping3 -1 -c 5 zombie_host
```

### 3. اجرای اسکن
```bash
nmap -sI zombie_host target.com
```

### 4. تحلیل نتایج
بررسی کنید کدام پورت‌ها به عنوان باز گزارش شده‌اند.

## مزایا

### ناشناس بودن کامل
- IP شما هرگز در لاگ‌های هدف ظاهر نمی‌شود
- تمام بسته‌ها از هاست zombie به نظر می‌رسند
- ردیابی به مهاجم دشوار است

### فرار از فایروال
- ممکن است کنترل‌های دسترسی مبتنی بر IP را دور بزند
- می‌تواند به عنوان ترافیک مشروع از zombie ظاهر شود
- زمانی که IP شما مسدود است مفید است

### مخفیانه بودن
- یکی از مخفیانه‌ترین روش‌های اسکن
- حتی با IDS/IPS سخت قابل تشخیص است
- دست‌دهی TCP را کامل نمی‌کند

## معایب

### عملکرد کند
- نیاز به چندین بررسی برای هر پورت
- خیلی کندتر از اسکن‌های مستقیم
- برای اسکن مقیاس بزرگ مناسب نیست

### وابستگی به Zombie
- نیاز به یافتن zombie مناسب دارد
- Zombie باید idle باقی بماند
- Zombie باید قابل دسترس باشد

### قابلیت اعتماد محدود
- نتایج می‌توانند تحت تأثیر فعالیت zombie قرار گیرند
- شرایط شبکه بر دقت تأثیر می‌گذارد
- ممکن است نتایج کاذب تولید کند

## تکنیک‌های پیشرفته

### استفاده از چند Zombie
```bash
# تست چند zombie برای تأیید نتایج
nmap -sI zombie1 target.com
nmap -sI zombie2 target.com
```

### ترکیب با گزینه‌های دیگر
```bash
# اسکن idle با تشخیص سرویس
nmap -sI zombie_host -sV target.com

# اسکن idle با تشخیص سیستم‌عامل
nmap -sI zombie_host -O target.com
```

## تشخیص اسکن‌های Idle

### سطح شبکه

**الگوهای ترافیک غیرعادی:**
- بسته‌های SYN از منابع غیرمنتظره
- بسته‌های RST به هاست‌هایی که اتصال را آغاز نکرده‌اند
- ترافیک همبسته از هاست‌های zombie

**امضاهای IDS:**
- جستجوی الگوهای بررسی IP ID
- نظارت بر بسته‌های جعلی
- تشخیص پاسخ‌های غیرعادی SYN-ACK

## دفاع در برابر اسکن‌های Idle

### اقدامات شبکه
- تصادفی کردن تولید IP ID
- پیاده‌سازی فیلترینگ خروجی
- نظارت بر بسته‌های جعلی
- استفاده از فایروال‌های stateful

### سخت‌سازی هاست
- پیکربندی هاست‌ها با IP ID تصادفی
- غیرفعال کردن سرویس‌های غیرضروری
- پیاده‌سازی محدودیت نرخ
- نظارت بر ترافیک خروجی

## مثال عملی

### گردش کار کامل اسکن Idle

```bash
# 1. یافتن کاندیدهای zombie
nmap -O --open 192.168.1.0/24 | grep "Incremental"

# 2. تست zombie
zombie="192.168.1.50"
hping3 -1 -c 10 -i u10000 $zombie

# 3. اجرای اسکن
nmap -sI $zombie -p 1-1000 target.com

# 4. تأیید نتایج با zombie متفاوت
nmap -sI 192.168.1.51 -p 1-1000 target.com
```

## انواع تولید IP ID

### افزایشی (Incremental)
- بهترین برای اسکن idle
- ID برای هر بسته 1 واحد افزایش می‌یابد
- قابل پیش‌بینی و قابل اعتماد

### تصادفی (Random)
- نمی‌تواند برای اسکن idle استفاده شود
- ID تصادفی است
- رایج در سیستم‌های مدرن

### خراب (Broken)
- IP ID ثابت یا صفر
- نمی‌تواند برای اسکن idle استفاده شود

## ملاحظات قانونی و اخلاقی

### نیاز به مجوز
- اسکن idle هنوز نیاز به اجازه دارد
- استفاده از zombie بدون رضایت ممکن است غیرقانونی باشد
- اسکن هدف نیاز به مجوز دارد

### استفاده مسئولانه
- فقط در سیستم‌های مجاز استفاده کنید
- تمام فعالیت‌ها را مستند کنید
- قوانین تعامل را دنبال کنید
- مسئولیت صاحب zombie را در نظر بگیرید

## بهترین روش‌ها

1. همیشه مجوز مناسب دریافت کنید
2. قابلیت اعتماد zombie را کاملاً تست کنید
3. از چند zombie برای تأیید نتایج استفاده کنید
4. تمام فعالیت‌های اسکن را مستند کنید
5. از پیامدهای قانونی آگاه باشید
6. تأثیر بر هاست zombie را در نظر بگیرید
7. از زمان‌بندی و فرکانس مناسب استفاده کنید
