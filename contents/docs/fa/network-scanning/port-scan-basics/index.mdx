---
title: مبانی اسکن پورت
description: مفاهیم اساسی و تکنیک‌های اسکن پورت در امنیت شبکه
---

## اسکن پورت چیست؟

اسکن پورت فرآیند بررسی یک سیستم هدف برای شناسایی پورت‌های باز و سرویس‌ها است. پورت‌ها نقاط انتهایی منطقی برای ارتباط شبکه هستند که از 0 تا 65535 هستند.

## دسته‌بندی پورت‌ها

### پورت‌های شناخته شده (0-1023)
برای سرویس‌ها و پروتکل‌های رایج رزرو شده‌اند.

**پورت‌های معروف:**
- **20/21**: FTP (پروتکل انتقال فایل)
- **22**: SSH (پوسته امن)
- **23**: Telnet
- **25**: SMTP (پروتکل انتقال ایمیل ساده)
- **53**: DNS (سیستم نام دامنه)
- **80**: HTTP (ترافیک وب)
- **443**: HTTPS (ترافیک وب امن)
- **110**: POP3 (ایمیل)
- **143**: IMAP (ایمیل)
- **3389**: RDP (پروتکل دسکتاپ از راه دور)

### پورت‌های ثبت شده (1024-49151)
توسط IANA برای سرویس‌های خاص اختصاص داده شده.

**پورت‌های ثبت شده رایج:**
- **3306**: پایگاه داده MySQL
- **5432**: پایگاه داده PostgreSQL
- **8080**: HTTP جایگزین
- **27017**: MongoDB

### پورت‌های داینامیک/خصوصی (49152-65535)
برای اهداف موقت یا خصوصی استفاده می‌شوند.

## پورت‌های TCP در مقابل UDP

### TCP (پروتکل کنترل انتقال)
- پروتکل اتصال‌محور
- تضمین تحویل بسته
- نیاز به دست‌دهی سه‌مرحله‌ای
- مثال‌ها: HTTP، FTP، SSH

### UDP (پروتکل دیتاگرام کاربر)
- پروتکل بدون اتصال
- بدون تضمین تحویل
- سریع‌تر اما کم‌اعتمادتر
- مثال‌ها: DNS، DHCP، VoIP

## وضعیت‌های پورت

### باز (Open)
پورت در حال پذیرش اتصالات است. سرویسی در حال گوش دادن به این پورت است.

**نشانه:**
- TCP: پاسخ SYN-ACK دریافت شد
- UDP: بدون پاسخ یا پاسخ برنامه خاص

### بسته (Closed)
پورت قابل دسترس است اما سرویسی گوش نمی‌دهد.

**نشانه:**
- TCP: بسته RST (Reset) دریافت شد
- UDP: پیام ICMP پورت غیرقابل دسترس

### فیلتر شده (Filtered)
پورت توسط فایروال یا فیلتر بسته مسدود شده.

**نشانه:**
- هیچ پاسخی دریافت نشد
- پیام خطای ICMP دریافت شد

### باز|فیلتر شده (Open|Filtered)
نمی‌توان تعیین کرد پورت باز است یا فیلتر شده.

**نشانه:**
- رایج در اسکن‌های UDP
- هیچ پاسخی دریافت نشد

### بسته|فیلتر شده (Closed|Filtered)
نمی‌توان تعیین کرد پورت بسته است یا فیلتر شده.

## فلگ‌های TCP

درک فلگ‌های TCP برای اسکن پورت ضروری است:

- **SYN**: همگام‌سازی - اتصال را آغاز می‌کند
- **ACK**: تأیید - دریافت را تأیید می‌کند
- **FIN**: پایان - اتصال را می‌بندد
- **RST**: بازنشانی - اتصال را لغو می‌کند
- **PSH**: فشار - داده را فوراً ارسال می‌کند
- **URG**: فوری - داده اولویت‌دار

## تکنیک‌های اسکن پورت

### اسکن TCP Connect
- دست‌دهی کامل سه‌مرحله‌ای را تکمیل می‌کند
- دقیق‌ترین روش
- به راحتی لاگ و تشخیص می‌شود
- نیاز به مجوزهای خاص ندارد

### اسکن SYN (اسکن مخفیانه)
- SYN ارسال می‌کند، منتظر SYN-ACK می‌ماند
- دست‌دهی را کامل نمی‌کند
- کمتر احتمال دارد لاگ شود
- نیاز به مجوزهای root/admin دارد
- محبوب‌ترین روش اسکن

### اسکن FIN
- بسته FIN ارسال می‌کند
- پورت‌های باز نادیده می‌گیرند، پورت‌های بسته RST ارسال می‌کنند
- می‌تواند برخی فایروال‌ها را دور بزند
- روی سیستم‌های Unix/Linux کار می‌کند

### اسکن NULL
- بسته بدون فلگ ارسال می‌کند
- پورت‌های باز نادیده می‌گیرند، پورت‌های بسته RST ارسال می‌کنند
- می‌تواند فایروال‌های ساده را دور بزند

### اسکن XMAS
- فلگ‌های FIN، PSH، URG ارسال می‌کند
- رفتار مشابه اسکن FIN
- به خاطر فلگ‌های "روشن شده" نامگذاری شده

### اسکن ACK
- قوانین فایروال را تعیین می‌کند
- پورت‌های فیلتر شده در مقابل فیلتر نشده را نقشه‌برداری می‌کند
- وضعیت باز/بسته را تعیین نمی‌کند

### اسکن Window
- مشابه اسکن ACK
- فیلد پنجره TCP را بررسی می‌کند
- می‌تواند پورت‌های باز را از بسته تشخیص دهد

### اسکن Maimon
- بسته FIN/ACK ارسال می‌کند
- روی برخی سیستم‌های BSD کار می‌کند

## اسکن UDP

### چالش‌ها
- پروتکل بدون اتصال
- کندتر از اسکن TCP
- نتایج کم‌اعتمادتر
- بسیاری از سرویس‌های UDP پاسخ نمی‌دهند

### فرآیند
1. ارسال بسته UDP به پورت
2. بدون پاسخ: پورت باز یا فیلتر شده
3. ICMP غیرقابل دسترس: پورت بسته
4. پاسخ سرویس: پورت باز

## زمان‌بندی و عملکرد

### ملاحظات سرعت اسکن
- **T0 (پارانوید)**: 5 دقیقه بین پروب‌ها
- **T1 (مخفیانه)**: 15 ثانیه بین پروب‌ها
- **T2 (مؤدبانه)**: 0.4 ثانیه بین پروب‌ها
- **T3 (عادی)**: زمان‌بندی پیش‌فرض
- **T4 (تهاجمی)**: اسکن سریع
- **T5 (دیوانه)**: سریع‌ترین، ممکن است پورت‌ها را از دست بدهد

## گرفتن بنر

ضبط بنرهای سرویس برای شناسایی:
- نوع سرویس
- اطلاعات نسخه
- جزئیات سیستم‌عامل
- آسیب‌پذیری‌های احتمالی

**روش‌ها:**
- اتصال به سرویس و خواندن بنر
- استفاده از netcat: `nc target port`
- خودکار با Nmap: `-sV`

## تشخیص نسخه سرویس

شناسایی نسخه‌های دقیق سرویس:
- دقیق‌تر از گرفتن بنر
- چندین پروب ارسال می‌کند
- پاسخ‌ها را با پایگاه داده تطبیق می‌دهد
- ضروری برای ارزیابی آسیب‌پذیری

## تکنیک‌های فرار

### تکه‌تکه کردن
تقسیم بسته‌ها به قطعات برای فرار از IDS.

### اسکن فریبنده
استفاده از چندین آدرس IP فریبنده برای مخفی کردن منبع واقعی.

### تصادفی‌سازی
تصادفی کردن ترتیب اسکن برای اجتناب از تشخیص الگو.

### اسکن کند
کاهش سرعت اسکن برای اجتناب از تشخیص.

### دستکاری پورت منبع
استفاده از پورت‌های منبع رایج (53، 80) برای دور زدن فیلترها.

## بهترین روش‌ها

### انطباق قانونی
- همیشه مجوز کتبی دریافت کنید
- محدوده را به وضوح مستند کنید
- قوانین قابل اجرا را دنبال کنید

### شیوه‌های فنی
- با اسکن‌های کم‌تهاجم‌تر شروع کنید
- به منابع شبکه احترام بگذارید
- تمام یافته‌ها را مستند کنید
- از زمان‌بندی مناسب استفاده کنید
- ساعات کاری را در نظر بگیرید

### اجتناب از تشخیص
- از VPN یا پروکسی استفاده کنید
- تکنیک‌های فرار را به کار ببرید
- هشدارهای IDS را نظارت کنید
- شدت اسکن را تنظیم کنید

## خطاهای رایج

### مثبت کاذب
پورت باز به نظر می‌رسد اما واقعاً قابل دسترس نیست.

### منفی کاذب
پورت بسته به نظر می‌رسد اما واقعاً باز است.

**علل:**
- قوانین فایروال
- محدودیت نرخ
- ازدحام شبکه
- پیکربندی نادرست اسکن
