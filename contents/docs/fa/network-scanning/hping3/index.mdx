---
title: Hping3
description: ابزار پیشرفته ساخت بسته و تست شبکه برای متخصصان امنیت
---

## Hping3 چیست؟

Hping3 یک ابزار خط فرمان برای مونتاژ/تحلیل بسته TCP/IP است. این یکی از قدرتمندترین ابزارها برای تست امنیت شبکه است که به کاربران اجازه می‌دهد بسته‌های سفارشی بسازند و پاسخ‌ها را تحلیل کنند.

## ویژگی‌های کلیدی

- ساخت بسته سفارشی
- ممیزی پشته TCP/IP
- تست فایروال
- اسکن پورت
- تست شبکه
- Traceroute با پروتکل‌های مختلف
- شناسایی سیستم‌عامل از راه دور
- تست DoS

## نصب

### Linux (Debian/Ubuntu)
```bash
sudo apt-get install hping3
```

### Linux (Red Hat/CentOS)
```bash
sudo yum install hping3
```

### macOS
```bash
brew install hping
```

## نحو پایه

```bash
hping3 [options] target
```

## گزینه‌های رایج

### گزینه‌های پایه
- `-c COUNT`: تعداد بسته‌ها برای ارسال
- `-i INTERVAL`: فاصله زمانی بین بسته‌ها (u برای میکروثانیه)
- `-V`: حالت پرحرف
- `--fast`: ارسال 10 بسته در ثانیه
- `--faster`: ارسال 100 بسته در ثانیه
- `--flood`: ارسال بسته‌ها با سرعت حداکثر

### گزینه‌های پروتکل
- `-0`: حالت RAW IP
- `-1`: حالت ICMP
- `-2`: حالت UDP
- `-8`: حالت SCAN
- `-9`: حالت گوش دادن

### گزینه‌های پورت
- `-p PORT`: پورت مقصد
- `--baseport PORT`: پورت منبع پایه
- `--destport PORT`: پورت مقصد
- `--keep`: نگه‌داشتن پورت منبع

### فلگ‌های TCP
- `-S`: فلگ SYN
- `-A`: فلگ ACK
- `-F`: فلگ FIN
- `-P`: فلگ PSH
- `-U`: فلگ URG
- `-R`: فلگ RST

## موارد استفاده رایج

### 1. Ping پایه ICMP
```bash
hping3 -1 target.com
```

### 2. اسکن SYN روی پورت خاص
```bash
hping3 -S -p 80 target.com
```

### 3. اسکن چند پورت
```bash
hping3 -S -p ++1 target.com
# پورت را برای هر بسته افزایش می‌دهد
```

### 4. اسکن محدوده پورت
```bash
hping3 -8 1-1000 -S target.com
```

### 5. بسته UDP
```bash
hping3 -2 -p 53 target.com
```

### 6. حمله Flood (تست)
```bash
hping3 --flood -S -p 80 target.com
```

### 7. Traceroute با TCP
```bash
hping3 -T -p 80 target.com
```

### 8. تست فایروال
```bash
hping3 -S -p 80 -c 3 target.com
```

## تکنیک‌های پیشرفته

### TCP SYN Flood
```bash
hping3 -S --flood -V -p 80 target.com
```

### جعل IP منبع
```bash
hping3 -a spoofed_ip -S -p 80 target.com
```

### تکه‌تکه کردن بسته‌ها
```bash
hping3 -f -p 80 target.com
```

### TTL سفارشی
```bash
hping3 -t 64 -S -p 80 target.com
```

### پورت منبع تصادفی
```bash
hping3 -S -p 80 --rand-source target.com
```

### برچسب زمانی TCP
```bash
hping3 -S -p 80 --tcp-timestamp target.com
```

## شناسایی سیستم‌عامل

```bash
# ارسال بسته‌ها با گزینه‌های TCP مختلف
hping3 -S -p 80 -c 1 target.com

# تحلیل TTL و اندازه پنجره از پاسخ
hping3 -S -p 80 -c 1 -V target.com
```

## فرار از فایروال

### استفاده از پروتکل‌های مختلف
```bash
# امتحان ICMP
hping3 -1 target.com

# امتحان UDP
hping3 -2 -p 53 target.com

# امتحان TCP روی پورت‌های رایج
hping3 -S -p 80 target.com
```

### تکه‌تکه کردن
```bash
hping3 -f -S -p 80 target.com
```

### اسکن کند
```bash
hping3 -S -p 80 -i u100000 target.com
# بسته را هر 0.1 ثانیه ارسال می‌کند
```

## تست شبکه

### تست پهنای باند
```bash
hping3 --flood -p 80 target.com
```

### تست تأخیر
```bash
hping3 -1 -c 10 target.com
```

### کشف MTU
```bash
hping3 -1 -d 1500 -N 1500 target.com
```

## تفسیر نتایج

### انواع پاسخ

**پاسخ‌های ICMP:**
- `ICMP Port Unreachable`: پورت بسته است
- `بدون پاسخ`: پورت ممکن است فیلتر شده باشد
- `پاسخ دریافت شد`: هاست زنده است

**پاسخ‌های TCP:**
- `flags=SA`: پورت باز است (SYN-ACK)
- `flags=RA`: پورت بسته است (RST-ACK)
- `بدون پاسخ`: پورت فیلتر شده است

### تحلیل TTL
مقادیر پیش‌فرض رایج TTL:
- **64**: Linux/Unix
- **128**: Windows
- **255**: Cisco/دستگاه‌های شبکه

## مثال‌های عملی

### 1. بررسی زنده بودن هاست
```bash
hping3 -1 -c 3 192.168.1.1
```

### 2. تست پورت خاص
```bash
hping3 -S -p 443 -c 5 example.com
```

### 3. دور زدن فایروال
```bash
# استفاده از پورت منبع 53 (DNS)
hping3 -S -p 80 -s 53 target.com
```

### 4. تشخیص Load Balancer
```bash
hping3 -S -p 80 -c 10 target.com
# بررسی کنید آیا پاسخ‌ها از IPهای مختلف می‌آیند
```

### 5. اسکن Idle
```bash
# یافتن هاست زامبی
hping3 -S -r -p 445 zombie_host

# اجرای اسکن
hping3 -a zombie_host -S -p 80 target.com
```

## اسکریپت‌نویسی Hping3

Hping3 از اسکریپت‌نویسی Tcl برای خودکارسازی پشتیبانی می‌کند:

```tcl
# نمونه اسکریپت
set target "192.168.1.1"
set port 80

hping send {ip(daddr=$target)+tcp(dport=$port,flags=s)}
```

## تشخیص و پیشگیری

### امضاهای IDS/IPS
اسکن Hping3 می‌تواند توسط موارد زیر تشخیص داده شود:
- نرخ بسته بالا از منبع واحد
- الگوهای اسکن پورت ترتیبی
- ترکیبات غیرعادی فلگ TCP
- بسته‌های تکه‌تکه شده

### اقدامات دفاعی
- محدودیت نرخ
- ردیابی اتصال
- تشخیص ناهنجاری
- بازرسی بسته

## موارد استفاده در تست نفوذ

1. **تست قوانین فایروال**: تأیید پیکربندی‌های فایروال
2. **تست IDS**: تست سیستم‌های تشخیص نفوذ
3. **نقشه‌برداری شبکه**: کشف توپولوژی شبکه
4. **کشف سرویس**: شناسایی سرویس‌های در حال اجرا
5. **تست DoS**: تست مقاومت در برابر سیل

## بهترین روش‌ها

- همیشه قبل از تست مجوز دریافت کنید
- از زمان‌بندی مناسب برای اجتناب از اختلال شبکه استفاده کنید
- تمام فعالیت‌های تست را مستند کنید
- از پیامدهای قانونی آگاه باشید
- در صورت امکان در محیط‌های ایزوله تست کنید

## محدودیت‌ها

- نیاز به مجوزهای root/admin دارد
- می‌تواند پرسروصدا و به راحتی قابل تشخیص باشد
- ممکن است خط‌مشی‌های شبکه را نقض کند
- نتایج می‌توانند توسط فایروال‌ها تحت تأثیر قرار گیرند
- محدود به پروتکل‌های TCP/IP

## جایگزین‌ها

- **Nmap**: ویژگی‌های بیشتر، استفاده آسان‌تر
- **Scapy**: دستکاری بسته انعطاف‌پذیرتر
- **Netcat**: ساده‌تر برای وظایف پایه
- **Masscan**: سریع‌تر برای اسکن مقیاس بزرگ
