---
title: شناسایی DNS
description: استفاده از کوئری‌ها و تحلیل DNS برای جمع‌آوری اطلاعات و شناسایی
---

## شناسایی DNS چیست؟

شناسایی DNS (سیستم نام دامنه) فرآیند جمع‌آوری اطلاعات درباره زیرساخت DNS سازمان هدف است، شامل نام‌های دامنه، آدرس‌های IP، سرورهای ایمیل و سرورهای نام.

## انواع رکورد DNS

### رکورد A (آدرس)
نقشه‌برداری نام دامنه به آدرس IPv4.
```
example.com → 192.168.1.1
```

### رکورد AAAA
نقشه‌برداری نام دامنه به آدرس IPv6.
```
example.com → 2001:0db8:85a3::8a2e:0370:7334
```

### رکورد MX (تبادل ایمیل)
مشخص کردن سرورهای ایمیل برای دامنه.
```
example.com → mail.example.com (اولویت: 10)
```

### رکورد NS (سرور نام)
شناسایی سرورهای نام معتبر برای دامنه.
```
example.com → ns1.example.com
```

### رکورد CNAME (نام متعارف)
ایجاد نام مستعار برای نام دامنه دیگر.
```
www.example.com → example.com
```

### رکورد TXT
ذخیره اطلاعات متنی، اغلب برای تأیید و امنیت.
```
خط‌مشی‌های SPF، DKIM، DMARC
```

### رکورد SOA (شروع اقتدار)
حاوی اطلاعات اداری درباره دامنه.

### رکورد PTR (اشاره‌گر)
جستجوی معکوس DNS - نقشه‌برداری IP به نام دامنه.

## تکنیک‌های شناسایی DNS

### انتقال منطقه DNS
تلاش برای بازیابی کل فایل منطقه DNS از سرورهای نام.
```bash
dig @nameserver example.com AXFR
nslookup
> server nameserver
> ls -d example.com
```

### شمارش DNS
کوئری سیستماتیک DNS برای کشف هاست‌ها و زیردامنه‌ها.

### جستجوی معکوس DNS
یافتن نام‌های دامنه مرتبط با آدرس‌های IP.
```bash
dig -x 192.168.1.1
nslookup 192.168.1.1
```

### شمارش زیردامنه
کشف زیردامنه‌های یک دامنه هدف.
```bash
# استفاده از حمله خشن
for sub in www mail ftp admin; do
    host $sub.example.com
done
```

## ابزارهای شناسایی DNS

### ابزارهای خط فرمان

**dig (جستجوگر اطلاعات دامنه)**
```bash
dig example.com
dig example.com MX
dig example.com NS
dig example.com ANY
```

**nslookup**
```bash
nslookup example.com
nslookup -type=mx example.com
nslookup -type=ns example.com
```

**host**
```bash
host example.com
host -t mx example.com
host -t ns example.com
```

**whois**
```bash
whois example.com
```

### ابزارهای خودکار

**DNSRecon**
ابزار جامع شمارش DNS.
```bash
dnsrecon -d example.com
dnsrecon -d example.com -t axfr
```

**Fierce**
شناسایی DNS و شمارش زیردامنه.
```bash
fierce --domain example.com
```

**DNSenum**
ابزار شمارش DNS چند رشته‌ای.
```bash
dnsenum example.com
```

**Sublist3r**
ابزار سریع شمارش زیردامنه.
```bash
sublist3r -d example.com
```

**Amass**
شمارش و نقشه‌برداری عمیق DNS.
```bash
amass enum -d example.com
```

### ابزارهای آنلاین

**DNSDumpster**
ابزار رایگان تحقیق دامنه با نقشه‌برداری بصری.

**SecurityTrails**
اطلاعات DNS و داده‌های تاریخی.

**ViewDNS.info**
مجموعه ابزارهای DNS و شبکه.

**MXToolbox**
جستجوی DNS و تشخیص.

## اطلاعات جمع‌آوری شده از DNS

### زیرساخت شبکه
- محدوده‌های آدرس IP
- اطلاعات زیرشبکه
- توپولوژی شبکه

### سرورهای ایمیل
- آدرس‌های سرور ایمیل
- اطلاعات مسیریابی ایمیل
- پیکربندی‌های SPF/DKIM

### زیردامنه‌ها
- سرورهای توسعه
- محیط‌های آزمایشی
- پنل‌های مدیریت
- اندپوینت‌های API

### سرویس‌های شخص ثالث
- ارائه‌دهندگان ابری
- سرویس‌های CDN
- سرویس‌های ایمیل
- ارائه‌دهندگان هاستینگ

## رکوردهای امنیتی DNS

### SPF (چارچوب خط‌مشی فرستنده)
جلوگیری از جعل ایمیل با مشخص کردن سرورهای ایمیل مجاز.
```
v=spf1 ip4:192.168.1.0/24 include:_spf.google.com ~all
```

### DKIM (ایمیل شناسایی شده با کلید دامنه)
احراز هویت ایمیل با استفاده از امضای دیجیتال.

### DMARC (احراز هویت پیام مبتنی بر دامنه)
خط‌مشی و گزارش‌دهی احراز هویت ایمیل.
```
v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com
```

### DNSSEC (پسوندهای امنیتی DNS)
افزودن امضاهای رمزنگاری به رکوردهای DNS.

## جاسوسی کش DNS

کوئری کش DNS برای کشف دامنه‌های از قبل حل شده.
```bash
dig @dns-server example.com +norecurse
```

## دفاع در برابر شناسایی DNS

### برای سازمان‌ها

**غیرفعال کردن انتقال منطقه**
محدود کردن AXFR فقط به سرورهای مجاز.

**DNS افق تقسیم شده**
جداسازی نماهای DNS داخلی و خارجی.

**محدودیت نرخ**
محدود کردن نرخ کوئری DNS از منابع واحد.

**پیاده‌سازی DNSSEC**
محافظت از یکپارچگی DNS با امضاهای رمزنگاری.

**نظارت بر ترافیک DNS**
تشخیص الگوهای غیرعادی کوئری.

### بهترین روش‌های پیکربندی
- حذف رکوردهای غیرضروری DNS
- استفاده از محدوده‌های IP خصوصی داخلی
- پیاده‌سازی ACL مناسب
- ممیزی منظم DNS
- مخفی کردن اطلاعات نسخه

## ملاحظات قانونی و اخلاقی

- کسب مجوز مناسب
- احترام به محدودیت‌های نرخ
- پیروی از افشای مسئولانه
- مستندسازی تمام فعالیت‌ها
- ماندن در محدوده تعامل
