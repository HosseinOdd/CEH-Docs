---
title: تشخیص بدافزار
description: تکنیک‌ها و ابزارها برای تشخیص نرم‌افزار مخرب
---

## رویکردهای تشخیص

### 1. تشخیص مبتنی بر امضا
- تطبیق الگو
- امضاهای بدافزار شناخته شده
- سریع و دقیق برای تهدیدات شناخته شده
- نمی‌تواند بدافزار جدید/ناشناخته را تشخیص دهد

### 2. تشخیص اکتشافی
- تحلیل رفتار
- الگوهای فعالیت مشکوک
- تشخیص بدافزار ناشناخته
- نرخ مثبت کاذب بالاتر

### 3. تشخیص رفتاری
- نظارت زمان اجرا
- تحلیل سیستم کال
- رفتار پروسس
- فعالیت شبکه

### 4. Sandbox
- محیط اجرای جداسازی شده
- تحلیل امن بدافزار
- مشاهده خودکار رفتار

### 5. یادگیری ماشین
- تشخیص مبتنی بر هوش مصنوعی
- تشخیص الگو
- یادگیری تطبیقی
- فناوری نوظهور

## ابزارهای تشخیص

### راه‌حل‌های آنتی‌ویروس
```bash
# ClamAV (Linux)
sudo apt install clamav
sudo freshclam
sudo clamscan -r /

# Windows Defender
Update-MpSignature
Start-MpScan -ScanType FullScan
```

### EDR (تشخیص و پاسخ نقطه پایانی)
- CrowdStrike Falcon
- Carbon Black
- SentinelOne
- Microsoft Defender for Endpoint

### تشخیص مبتنی بر شبکه
```bash
# Snort IDS
sudo snort -A console -c /etc/snort/snort.conf -i eth0

# Suricata
sudo suricata -c /etc/suricata/suricata.yaml -i eth0
```

### قوانین YARA
```yara
rule MalwareDetection
{
    meta:
        description = "Detects specific malware"
    strings:
        $str1 = "malicious_string"
        $hex1 = { 6A 40 68 00 30 00 00 }
    condition:
        $str1 or $hex1
}
```

## نشانگرهای سازش (IOCs)

### IOCهای مبتنی بر فایل
- هش‌های MD5/SHA256
- نام فایل‌ها
- اندازه فایل‌ها
- مسیرهای فایل

### IOCهای شبکه
- آدرس‌های IP
- نام‌های دامنه
- URLها
- آدرس‌های ایمیل

### IOCهای رفتاری
- تغییرات رجیستری
- تزریق پروسس
- ترافیک غیرعادی شبکه
- افزایش امتیاز

## تکنیک‌های تشخیص

### تحلیل ایستا
```bash
# اطلاعات فایل
file malware.exe
strings malware.exe
hexdump -C malware.exe

# محاسبه هش
md5sum malware.exe
sha256sum malware.exe

# اسکن با VirusTotal
curl --request POST \
  --url 'https://www.virustotal.com/api/v3/files' \
  --header 'x-apikey: YOUR_API_KEY' \
  --form file=@malware.exe
```

### تحلیل پویا
```bash
# نظارت بر سیستم کال‌ها
strace -f ./malware
ltrace ./malware

# نظارت بر عملیات فایل
inotifywait -m -r /tmp

# نظارت شبکه
tcpdump -i any -w capture.pcap
```

### تحلیل حافظه
```bash
# Volatility Framework
volatility -f memory.dump imageinfo
volatility -f memory.dump pslist
volatility -f memory.dump netscan
volatility -f memory.dump malfind
```

## اسکنرهای آنلاین

### VirusTotal
- اسکن چند موتوری
- +70 موتور آنتی‌ویروس
- جستجوی فایل/URL/هش
- API موجود

### Hybrid Analysis
- Sandbox خودکار
- گزارش‌های دقیق
- نسخه‌های رایگان و پولی

### Any.run
- Sandbox تعاملی
- تحلیل لحظه‌ای
- مبتنی بر مرورگر

## فرار از تشخیص (دیدگاه مهاجم)

### تکنیک‌ها
- مبهم‌سازی کد
- رمزگذاری/بسته‌بندی
- ضد اشکال‌زدایی
- تشخیص ضد VM
- کد چندشکلی
- زندگی از زمین

### مقابله با فرار
- بازرسی عمیق بسته
- اسکن حافظه
- تحلیل رفتاری
- هوش تهدید

## مثبت‌های کاذب

### علل
- نرم‌افزار قانونی پرچم‌گذاری شده
- دامنه بیش از حد اکتشافی
- امضاهای قدیمی
- PUPها (برنامه‌های احتمالاً ناخواسته)

### کاهش
- لیست سفید فایل‌های خوب شناخته شده
- گزارش مثبت‌های کاذب
- به‌روزرسانی تعاریف
- پیکربندی حساسیت

## بهترین روش‌ها

1. **رویکرد چندلایه**
2. **نگه داشتن امضاها به‌روز**
3. **استفاده از روش‌های تشخیص متعدد**
4. **اسکن‌های منظم**
5. **نظارت بر رفتار سیستم**
6. **یکپارچه‌سازی هوش تهدید**
7. **آموزش آگاهی کاربر**

## منابع

- VirusTotal: https://www.virustotal.com
- Hybrid Analysis: https://www.hybrid-analysis.com
- Any.run: https://any.run
- YARA: https://virustotal.github.io/yara/
- Volatility: https://www.volatilityfoundation.org/
