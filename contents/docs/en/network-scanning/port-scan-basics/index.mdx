---
title: Port Scanning Basics
description: Fundamental concepts and techniques of port scanning in network security
---

## What is Port Scanning?

Port scanning is the process of probing a target system to identify open ports and services. Ports are logical endpoints for network communication, ranging from 0 to 65535.

## Port Categories

### Well-Known Ports (0-1023)
Reserved for common services and protocols.

**Common Well-Known Ports:**
- **20/21**: FTP (File Transfer Protocol)
- **22**: SSH (Secure Shell)
- **23**: Telnet
- **25**: SMTP (Simple Mail Transfer Protocol)
- **53**: DNS (Domain Name System)
- **80**: HTTP (Web Traffic)
- **443**: HTTPS (Secure Web Traffic)
- **110**: POP3 (Email)
- **143**: IMAP (Email)
- **3389**: RDP (Remote Desktop Protocol)

### Registered Ports (1024-49151)
Assigned by IANA for specific services.

**Common Registered Ports:**
- **3306**: MySQL Database
- **5432**: PostgreSQL Database
- **8080**: HTTP Alternate
- **27017**: MongoDB

### Dynamic/Private Ports (49152-65535)
Used for temporary or private purposes.

## TCP vs UDP Ports

### TCP (Transmission Control Protocol)
- Connection-oriented protocol
- Guarantees packet delivery
- Three-way handshake required
- Examples: HTTP, FTP, SSH

### UDP (User Datagram Protocol)
- Connectionless protocol
- No delivery guarantee
- Faster but less reliable
- Examples: DNS, DHCP, VoIP

## Port States

### Open
Port is accepting connections. A service is listening on this port.

**Indication:**
- TCP: SYN-ACK response received
- UDP: No response or specific application response

### Closed
Port is accessible but no service is listening.

**Indication:**
- TCP: RST (Reset) packet received
- UDP: ICMP port unreachable message

### Filtered
Port is blocked by firewall or packet filter.

**Indication:**
- No response received
- ICMP error message received

### Open|Filtered
Cannot determine if port is open or filtered.

**Indication:**
- Common with UDP scans
- No response received

### Closed|Filtered
Cannot determine if port is closed or filtered.

## TCP Flags

Understanding TCP flags is essential for port scanning:

- **SYN**: Synchronize - Initiates connection
- **ACK**: Acknowledgment - Confirms receipt
- **FIN**: Finish - Closes connection
- **RST**: Reset - Aborts connection
- **PSH**: Push - Sends data immediately
- **URG**: Urgent - Priority data

## Port Scanning Techniques

### TCP Connect Scan
- Completes full three-way handshake
- Most accurate method
- Easily logged and detected
- Requires no special privileges

### SYN Scan (Stealth Scan)
- Sends SYN, waits for SYN-ACK
- Doesn't complete handshake
- Less likely to be logged
- Requires root/admin privileges
- Most popular scanning method

### FIN Scan
- Sends FIN packet
- Open ports ignore, closed ports send RST
- Can bypass some firewalls
- Works on Unix/Linux systems

### NULL Scan
- Sends packet with no flags
- Open ports ignore, closed ports send RST
- Can bypass simple firewalls

### XMAS Scan
- Sends FIN, PSH, URG flags
- Similar behavior to FIN scan
- Named for "lit up" flags

### ACK Scan
- Determines firewall rules
- Maps filtered vs unfiltered ports
- Doesn't determine open/closed state

### Window Scan
- Similar to ACK scan
- Examines TCP window field
- Can distinguish open from closed ports

### Maimon Scan
- Sends FIN/ACK packet
- Works on some BSD systems

## UDP Scanning

### Challenges
- Connectionless protocol
- Slower than TCP scanning
- Less reliable results
- Many UDP services don't respond

### Process
1. Send UDP packet to port
2. No response: Port open or filtered
3. ICMP unreachable: Port closed
4. Service response: Port open

## Timing and Performance

### Scan Speed Considerations
- **T0 (Paranoid)**: 5 minutes between probes
- **T1 (Sneaky)**: 15 seconds between probes
- **T2 (Polite)**: 0.4 seconds between probes
- **T3 (Normal)**: Default timing
- **T4 (Aggressive)**: Fast scan
- **T5 (Insane)**: Fastest, may miss ports

## Banner Grabbing

Capturing service banners to identify:
- Service type
- Version information
- Operating system details
- Potential vulnerabilities

**Methods:**
- Connect to service and read banner
- Use netcat: `nc target port`
- Automated with Nmap: `-sV`

## Service Version Detection

Identifying exact service versions:
- More accurate than banner grabbing
- Sends multiple probes
- Matches responses against database
- Essential for vulnerability assessment

## Evasion Techniques

### Fragmentation
Split packets into fragments to evade IDS.

### Decoy Scanning
Use multiple decoy IP addresses to hide real source.

### Randomization
Randomize scan order to avoid pattern detection.

### Slow Scanning
Reduce scan speed to avoid detection.

### Source Port Manipulation
Use common source ports (53, 80) to bypass filters.

## Best Practices

### Legal Compliance
- Always get written authorization
- Document scope clearly
- Follow applicable laws

### Technical Practices
- Start with less intrusive scans
- Respect network resources
- Document all findings
- Use appropriate timing
- Consider business hours

### Detection Avoidance
- Use VPN or proxy
- Employ evasion techniques
- Monitor for IDS alerts
- Adjust scan intensity

## Common Errors

### False Positives
Port appears open but isn't actually accessible.

### False Negatives
Port appears closed but is actually open.

**Causes:**
- Firewall rules
- Rate limiting
- Network congestion
- Incorrect scan configuration
