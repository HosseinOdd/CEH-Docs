---
title: Malware Lifecycle
description: Understanding malware infection stages and propagation
---

## Malware Lifecycle Phases

### 1. Initial Infection
**Entry Points:**
- Email attachments
- Malicious downloads
- Drive-by downloads
- USB/removable media
- Network exploitation
- Social engineering

### 2. Execution
- User activates malware
- Exploit triggers execution
- Auto-run features
- Scheduled tasks

### 3. Persistence
**Techniques:**
```bash
# Registry (Windows)
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

# Cron jobs (Linux)
crontab -e
@reboot /path/to/malware

# Systemd services
/etc/systemd/system/malware.service
```

### 4. Privilege Escalation
- Exploit vulnerabilities
- Credential theft
- Token manipulation
- DLL hijacking

### 5. Defense Evasion
- Disable antivirus
- Clear logs
- Rootkit installation
- Process injection

### 6. Discovery
- Network scanning
- System enumeration
- User/account discovery
- File/directory enumeration

### 7. Lateral Movement
- Credential dumping
- Remote services
- Pass-the-hash
- Pivot through systems

### 8. Collection
- Data staging
- Screen capture
- Keylogging
- Clipboard data

### 9. Exfiltration
- HTTP/HTTPS channels
- DNS tunneling
- FTP/SFTP
- Cloud services

### 10. Impact
- Data destruction
- Encryption (ransomware)
- Resource hijacking
- Denial of service

## Persistence Mechanisms

### Windows
```powershell
# Run keys
New-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -Name "Malware" -Value "C:\malware.exe"

# Scheduled tasks
schtasks /create /tn "Malware" /tr "C:\malware.exe" /sc onlogon

# Services
sc create MalwareService binPath= "C:\malware.exe" start= auto
```

### Linux
```bash
# Cron jobs
echo "@reboot /tmp/malware" | crontab -

# Systemd service
cat > /etc/systemd/system/malware.service <<EOF
[Unit]
Description=Malware Service
[Service]
ExecStart=/tmp/malware
[Install]
WantedBy=multi-user.target
EOF
systemctl enable malware.service

# rc.local
echo "/tmp/malware &" >> /etc/rc.local
```

## Kill Chain Model

### Lockheed Martin Cyber Kill Chain
1. **Reconnaissance**: Target research
2. **Weaponization**: Create exploit
3. **Delivery**: Transmit to victim
4. **Exploitation**: Execute code
5. **Installation**: Install malware
6. **Command & Control**: C2 communication
7. **Actions on Objectives**: Achieve goal

## MITRE ATT&CK Framework

### Tactics
- Initial Access
- Execution
- Persistence
- Privilege Escalation
- Defense Evasion
- Credential Access
- Discovery
- Lateral Movement
- Collection
- Command and Control
- Exfiltration
- Impact

## Detection Points

### Early Stage
- Network anomalies
- Suspicious emails
- Unknown downloads

### Mid Stage
- Process behavior
- Registry changes
- New services
- Network connections

### Late Stage
- Data exfiltration
- System changes
- Performance degradation

## Incident Response

### Preparation
- IR plan
- Tools ready
- Team trained

### Identification
- Detect incident
- Analyze scope
- Collect evidence

### Containment
- Isolate systems
- Stop spread
- Preserve evidence

### Eradication
- Remove malware
- Patch vulnerabilities
- Strengthen defenses

### Recovery
- Restore systems
- Monitor for reinfection
- Validate integrity

### Lessons Learned
- Document incident
- Improve processes
- Update defenses

## Timeline Analysis

```
T+0:    Initial infection
T+5m:   Execution begins
T+10m:  Persistence established
T+30m:  Lateral movement
T+1h:   Data collection
T+2h:   Exfiltration attempt
T+3h:   Detection (ideally)
```

## Resources

- MITRE ATT&CK: https://attack.mitre.org
- Cyber Kill Chain
- NIST Incident Response Guide
