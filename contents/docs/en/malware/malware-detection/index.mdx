---
title: Malware Detection
description: Techniques and tools for detecting malicious software
---

## Detection Approaches

### 1. Signature-Based Detection
- Pattern matching
- Known malware signatures
- Fast and accurate for known threats
- Cannot detect new/unknown malware

### 2. Heuristic Detection
- Behavior analysis
- Suspicious activity patterns
- Detects unknown malware
- Higher false positive rate

### 3. Behavioral Detection
- Runtime monitoring
- System call analysis
- Process behavior
- Network activity

### 4. Sandboxing
- Isolated execution environment
- Safe malware analysis
- Automated behavior observation

### 5. Machine Learning
- AI-powered detection
- Pattern recognition
- Adaptive learning
- Emerging technology

## Detection Tools

### Antivirus Solutions
```bash
# ClamAV (Linux)
sudo apt install clamav
sudo freshclam
sudo clamscan -r /

# Windows Defender
Update-MpSignature
Start-MpScan -ScanType FullScan
```

### EDR (Endpoint Detection & Response)
- CrowdStrike Falcon
- Carbon Black
- SentinelOne
- Microsoft Defender for Endpoint

### Network-Based Detection
```bash
# Snort IDS
sudo snort -A console -c /etc/snort/snort.conf -i eth0

# Suricata
sudo suricata -c /etc/suricata/suricata.yaml -i eth0
```

### YARA Rules
```yara
rule MalwareDetection
{
    meta:
        description = "Detects specific malware"
    strings:
        $str1 = "malicious_string"
        $hex1 = { 6A 40 68 00 30 00 00 }
    condition:
        $str1 or $hex1
}
```

## Indicators of Compromise (IOCs)

### File-Based IOCs
- MD5/SHA256 hashes
- File names
- File sizes
- File paths

### Network IOCs
- IP addresses
- Domain names
- URLs
- Email addresses

### Behavioral IOCs
- Registry modifications
- Process injection
- Unusual network traffic
- Privilege escalation

## Detection Techniques

### Static Analysis
```bash
# File information
file malware.exe
strings malware.exe
hexdump -C malware.exe

# Hash calculation
md5sum malware.exe
sha256sum malware.exe

# Scan with VirusTotal
curl --request POST \
  --url 'https://www.virustotal.com/api/v3/files' \
  --header 'x-apikey: YOUR_API_KEY' \
  --form file=@malware.exe
```

### Dynamic Analysis
```bash
# Monitor system calls
strace -f ./malware
ltrace ./malware

# Monitor file operations
inotifywait -m -r /tmp

# Network monitoring
tcpdump -i any -w capture.pcap
```

### Memory Analysis
```bash
# Volatility Framework
volatility -f memory.dump imageinfo
volatility -f memory.dump pslist
volatility -f memory.dump netscan
volatility -f memory.dump malfind
```

## Online Scanners

### VirusTotal
- Multi-engine scanning
- 70+ antivirus engines
- File/URL/hash lookup
- API available

### Hybrid Analysis
- Automated sandbox
- Detailed reports
- Free and paid versions

### Any.run
- Interactive sandbox
- Real-time analysis
- Browser-based

## Detection Evasion (Attacker Perspective)

### Techniques
- Code obfuscation
- Encryption/packing
- Anti-debugging
- Anti-VM detection
- Polymorphic code
- Living off the land

### Countering Evasion
- Deep packet inspection
- Memory scanning
- Behavioral analysis
- Threat intelligence

## False Positives

### Causes
- Legitimate software flagged
- Heuristic overreach
- Outdated signatures
- PUPs (Potentially Unwanted Programs)

### Mitigation
- Whitelist known-good files
- Report false positives
- Update definitions
- Configure sensitivity

## Best Practices

1. **Multi-layered approach**
2. **Keep signatures updated**
3. **Use multiple detection methods**
4. **Regular scans**
5. **Monitor system behavior**
6. **Threat intelligence integration**
7. **User awareness training**

## Resources

- VirusTotal: https://www.virustotal.com
- Hybrid Analysis: https://www.hybrid-analysis.com
- Any.run: https://any.run
- YARA: https://virustotal.github.io/yara/
- Volatility: https://www.volatilityfoundation.org/
